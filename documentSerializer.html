<!DOCTYPE html><html><head>
      <title>documentSerializer</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\home\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.19\crossnote\dependencies\katex\katex.min.css">
      
      
      <script type="text/javascript" src="file:///c:\Users\home\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.19\crossnote\dependencies\mermaid\mermaid.min.js" charset="UTF-8"></script>
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h2 id="proposal-for-document-serialization-interfaces">Proposal for Document Serialization Interfaces </h2>
<h3 id="introduction">Introduction </h3>
<ul>
<li>We define a generalized "data operation" from which all specific data operations can be derived.</li>
<li>Serialization operators can be specified as
<ul>
<li>A transformation to or from a <code>Document</code> to another format. (e.g. JSON, SLX, glTF)</li>
<li>An extraction of packaging to or from another format (e.g. ZIP, USD)</li>
<li>The data in the other format may reside in an arbitrary location and is not restricted to residing on local file systems.</li>
</ul>
</li>
<li>The interfaces for serialization should be designed to be thread-safe.</li>
<li>The interfaces should also not preclude usage by request-based / asynchronous APIs, though this will be a separate future consideration.
<ul>
<li>It is possible to have "read" operations not return any data, but instead provide a callback or future/promise mechanism for the caller to receive the data when it becomes available. "write" operations could also use a similar mechanisms to indicate completion status.</li>
<li>We note that the existing XML serialization and deserialization is not thread-safe and synchronous and will not be addressing this here.</li>
</ul>
</li>
</ul>
<h3 id="implementation-details">Implementation Details </h3>
<ul>
<li>All code interfaces are available in C++ and will provide bindings for other supported languages. This currently includes Javascript and Python.</li>
<li>Interfaces must include an API entry point which can take as input or output a <code>URI</code>. (This matches with the current MaterialX specification).</li>
<li>Not all input / output types can support string / stream output these entry points are optional. It is up to the implementation to decide what makes sense. e.g. it is possible to encode / decode binary data to / from strings for transport but could be very inefficient.</li>
<li>Interfaces will support optional user options / arguments to be specified. In general these may be anything from value arguments to function pointers.</li>
<li>Most command line and user interfaces define options in a key-value format. As such, it is useful to provide a reusable interface for this.</li>
<li>For life-time management all interfaces will be shared pointers, which is consistent with all other classes in the code base.</li>
<li>Options many or may not be reference counted.</li>
</ul>
<h3 id="operation-class">Operation Class </h3>
<ul>
<li>This is the base class for all operations.</li>
<li>It does not define storage or access points.</li>
<li>The interface class simply specifies a unique name identifier.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-using">using</span> Operation  <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Operation<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">Operation</span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">Operation</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> string<span class="token operator">&amp;</span> name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token operator">~</span><span class="token function">Operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-const">const</span> string<span class="token operator">&amp;</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token punctuation">{</span> <span class="token keyword keyword-return">return</span> _name<span class="token punctuation">;</span> <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    string _name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="options-structure">Options Structure </h3>
<ul>
<li>An operation may have one or more options / arguments associated with it.</li>
<li>These options can be used to customize the behavior of the operation.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">OperationOptions</span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">OperationOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token operator">~</span><span class="token function">OperationOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>A common way to specify arguments is with key-value pairs.</li>
<li>As such, we introduce a reusable interface for this.</li>
<li>This will allow for options to be extended without modifying the original class and can be used for creating command line or interactive user interfaces.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-using">using</span> KeyValueMap <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> ValuePtr<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">KeyValueOptions</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">OperationOptions</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">KeyValueOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">setOption</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> key<span class="token punctuation">,</span> ValuePtr value<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _options<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ValuePtr <span class="token function">getOption</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> key<span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-auto">auto</span> it <span class="token operator">=</span> _options<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> _options<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> it<span class="token operator">-&gt;</span>second <span class="token operator">:</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    KeyValueMap _options<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><h3 id="file-paths">File Paths </h3>
<p>Note that we do not require usage of file search via the existing MaterialX search paths as they only work on local file systems on desktop and are thus not generally applicable. We do <em>not</em> assume that integrations will support frameworks such as virtual file systems, nor do we assume that all assets are statically packaged with the integration (e.g. web-pack for Javascript deployment).</p>
<p>Currently a file search paths option is only used for supporting  "include" directives which are only supported for some formats such as XML, but not in other formats such as JSON.</p>
<h3 id="interface-class-for-document-readers">Interface Class for Document Readers </h3>
<p>For a document reader interface we add in the existing API methods provided by the current XML reader to make the transition to the new interface easier.<br>
As noted, support for string and stream data inputs is optional.</p>
<p>Optional arguments are passed in via the <code>OperationOptions</code> interface.</p>
<p>A list of format extensions may be returned to indicate the supported output formats. There are of the form: ".<extension>".<br>
For example for <code>glTF</code> this could be "[".gltf", ".glb"].</extension></p>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-using">using</span> DocumentReaderPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>DocumentReader<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">DocumentReader</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">Operation</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>

    <span class="token keyword keyword-virtual">virtual</span> DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> FilePath<span class="token operator">&amp;</span> uri<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-virtual">virtual</span> DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-virtual">virtual</span> DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> stream<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-virtual">virtual</span> StringVec <span class="token function">supportedExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="interface-class-for-document-writers">Interface Class for Document Writers </h3>
<p>For a document writer, we add in the existing API methods provided by the current XML writer to make the transition to the new interface easier.<br>
As noted, support for string and stream data outputs is optional.</p>
<p>Optional arguments are passed in via the <code>OperationOptions</code> interface.</p>
<p>A list of format extensions may be returned to indicate the supported output formats. There are of the form: ".<extension>".<br>
For a USD writer this could be "[".usda", ".usdz", ".usd"].</extension></p>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-using">using</span> DocumentWriterPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>DocumentWriter<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">DocumentWriter</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">Operation</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token keyword keyword-bool">bool</span> <span class="token function">write</span><span class="token punctuation">(</span>DocumentPtr<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> FilePath<span class="token operator">&amp;</span> uri<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token keyword keyword-bool">bool</span> <span class="token function">write</span><span class="token punctuation">(</span>DocumentPtr<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token keyword keyword-void">void</span> <span class="token function">write</span><span class="token punctuation">(</span>DocumentPtr<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> stream<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-virtual">virtual</span> StringVec <span class="token function">supportedExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="xml-reader-wrapper-class">XML Reader Wrapper Class </h3>
<ul>
<li>
<p>Due to all the global references used, the easiest way to make this work without code changes is to add interfaces in-place into <code>Xmlio.cpp</code></p>
</li>
<li>
<p>Global functions which are not currently part of the public API, can be made into local statics to decrease exposed surface area.</p>
</li>
<li>
<p>Current global public functions can be made local if / when this new interface replaces the existing interface.</p>
</li>
<li>
<p>For readability, error handling has been left out.</p>
</li>
</ul>
<h4 id="xml-reader-options">XML Reader Options </h4>
<ul>
<li>We consolidate all of the existing options into a single class which derives from the <code>OperationOptions</code> interface.</li>
<li>A example small variation is shown here to support automatic library inclusion of standard libraries.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">XmlDocumentReadOptions</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">OperationOptions</span><span class="token punctuation">,</span> <span class="token class-name">XmlReadOptions</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Include search path option from existing interface</span>
    FileSearchPath _searchPath <span class="token operator">=</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Extend to include standard library</span>
    DocumentPtr _standardLibrary <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h4 id="xml-reader">XML Reader </h4>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token comment">// XML Reader </span>
<span class="token keyword keyword-using">using</span> XMLDocumentPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>XMLDocument<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">XMLDocumentReader</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">DocumentReader</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">XMLDocumentReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> FilePath<span class="token operator">&amp;</span> uri<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        DocumentPtr doc <span class="token operator">=</span> <span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            doc<span class="token operator">-&gt;</span><span class="token function">setDataLibrary</span><span class="token punctuation">(</span>options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">readFromXmlFile</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> 
                        options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        DocumentPtr doc <span class="token operator">=</span> <span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            doc<span class="token operator">-&gt;</span><span class="token function">setDataLibrary</span><span class="token punctuation">(</span>options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">readFromXmlString</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> data<span class="token punctuation">,</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> stream<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        DocumentPtr doc <span class="token operator">=</span> <span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            doc<span class="token operator">-&gt;</span><span class="token function">setDataLibrary</span><span class="token punctuation">(</span>options<span class="token operator">-&gt;</span>_standardLibrary<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">readFromXmlStream</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> stream<span class="token punctuation">,</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    StringVec <span class="token function">supportedExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> _supportedExtensions<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    StringVec _supportedExtensions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">".mtlx"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="xml-writer-wrapper-class">XML Writer Wrapper Class </h3>
<ul>
<li>As with read options we add in a new interface for write options</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">XMLDocumentWriteOptions</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">OperationOptions</span><span class="token punctuation">,</span> <span class="token class-name">XmlWriteOptions</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Extend to include current search path</span>
    FileSearchPath _searchPath <span class="token operator">=</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>The writer class is similar to the reader class.</li>
<li>Note: There is a <code>prependXInclude()</code> global function that is unused and if kept should belong with <code>Document</code> class.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-using">using</span> XMLDocumentWriterPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>XMLDocumentWriter<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">XMLDocumentWriter</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">DocumentWriter</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">XMLDocumentWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-bool">bool</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> DocumentPtr doc<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> FilePath<span class="token operator">&amp;</span> uri<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">writeToXmlFile</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> uri<span class="token punctuation">,</span> options <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-bool">bool</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> DocumentPtr doc<span class="token punctuation">,</span> <span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">writeToXmlString</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> data<span class="token punctuation">,</span> options <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-bool">bool</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> DocumentPtr doc<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> stream<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">writeToXmlStream</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> stream<span class="token punctuation">,</span> options <span class="token operator">?</span> options<span class="token operator">-&gt;</span>_searchPath <span class="token operator">:</span> <span class="token function">FileSearchPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    StringVec <span class="token function">supportedExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> _supportedExtensions<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    StringVec _supportedExtensions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">".mtlx"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><h2 id="examples">Examples </h2>
<p>The following examples demonstrate other possible serializer extensions.</p>
<h3 id="c-http-reader-class">C++ HTTP Reader Class </h3>
<ul>
<li>The following example shows extensions for both the options and reader interface classes.</li>
<li>We add both MaterialX and ZIP formats as possible data formats, though only the MaterialX logic is shown.</li>
</ul>
<p><strong>Use Case</strong></p>
<ul>
<li>This could be used to read MaterialX documents or packaged zip assets from remote material repositories such as <code>ambientCG</code>, <code>PolyHaven</code>, <code>GPUOpen</code>, <code>PhysicallyBased</code> etc.</li>
<li>One issue with embedding this code into the core is that there is a need to add an explicit build time dependency -- in this case in the form of the C++ <code>CURL</code> library.</li>
<li>An extension can separate this dependency and only include it as needed.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token comment">// C++ http loader. </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>CURL_INSTALLED<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;curl/curl.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">HTTPXMLOptions</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">OperationOptions</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">HTTPXMLOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">setHttpOptions</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> HttpRequestOptions<span class="token operator">&amp;</span> options<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _timeout <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _connectTimeout <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">connectTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _headers <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> timeout<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _timeout <span class="token operator">=</span> timeout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">setHeaders</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> StringMap<span class="token operator">&amp;</span> headers<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _headers <span class="token operator">=</span> headers<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-int">int</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> _timeout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-int">int</span> <span class="token function">connectTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> _connectTimeout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    <span class="token keyword keyword-int">int</span> _timeout <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-int">int</span> _connectTimeout <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    StringMap _headers<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-using">using</span> HTTPXMLReaderPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>HTTPXMLReader<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-class">class</span> <span class="token class-name">HTTPXMLReader</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">DocumentReader</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token function">HTTPXMLReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token function">curl_global_init</span><span class="token punctuation">(</span>CURL_GLOBAL_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-virtual">virtual</span> <span class="token operator">~</span><span class="token function">HTTPXMLReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">curl_global_cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>   

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> FilePath<span class="token operator">&amp;</span> uri<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        HTTPXMLOptions httpOptions<span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            httpOptions<span class="token punctuation">.</span><span class="token function">setHttpOptions</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>HttpRequestOptions<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>

        std<span class="token double-colon punctuation">::</span>string materialString<span class="token punctuation">;</span>

        CURL<span class="token operator">*</span> curl<span class="token punctuation">;</span>
        CURLcode res<span class="token punctuation">;</span>
        curl <span class="token operator">=</span> <span class="token function">curl_easy_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>curl<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_URL<span class="token punctuation">,</span> uri<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_WRITEFUNCTION<span class="token punctuation">,</span> WriteCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_WRITEDATA<span class="token punctuation">,</span> <span class="token operator">&amp;</span>materialString<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// For HTTPS</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_SSL_VERIFYPEER<span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_SSL_VERIFYHOST<span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Set timeout settings for network requests</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_TIMEOUT<span class="token punctuation">,</span> httpOptions<span class="token punctuation">.</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_easy_setopt</span><span class="token punctuation">(</span>curl<span class="token punctuation">,</span> CURLOPT_CONNECTTIMEOUT<span class="token punctuation">,</span> httpOptions<span class="token punctuation">.</span><span class="token function">connectTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            res <span class="token operator">=</span> <span class="token function">curl_easy_perform</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>res <span class="token operator">!=</span> CURLE_OK<span class="token punctuation">)</span>
                <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>

            <span class="token function">curl_easy_cleanup</span><span class="token punctuation">(</span>curl<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>materialString<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                XMLDocumentReader reader<span class="token punctuation">;</span>
                DocumentPtr doc <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>materialString<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-return">return</span> doc<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    DocumentPtr <span class="token function">read</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> stream<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    StringVec <span class="token function">supportedExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token keyword keyword-override">override</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> _supportedExtensions<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    StringVec _supportedExtensions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">".mtlx"</span><span class="token punctuation">,</span> <span class="token string">".zip"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="python-zip-file-writer">Python Zip File Writer </h3>
<ul>
<li>This is a Python example of a custom <code>DocumentWriter</code> that saves a MaterialX document and its referenced textures into a ZIP file.</li>
<li>Dependencies are part of the module / package.</li>
<li>Integrations would handle any error exceptions including package imports</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> logging
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token comment"># Dependency check</span>
have_zip <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-import">import</span> zipfile
    <span class="token keyword keyword-import">import</span> tempfile
    <span class="token keyword keyword-import">import</span> MaterialX <span class="token keyword keyword-as">as</span> mx
    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"MaterialX and zip modules loaded successfully"</span><span class="token punctuation">)</span>
    have_zip <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword keyword-except">except</span> ImportError<span class="token punctuation">:</span>
    <span class="token keyword keyword-raise">raise</span> ImportError<span class="token punctuation">(</span><span class="token string">"Please ensure MaterialX and zipfile modules are installed."</span><span class="token punctuation">)</span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">ZipWriter</span><span class="token punctuation">(</span>mx<span class="token punctuation">.</span>DocumentWriter<span class="token punctuation">)</span><span class="token punctuation">:</span>
    _plugin_name <span class="token operator">=</span> <span class="token string">"ZipWriter"</span>
    _ui_name <span class="token operator">=</span> <span class="token string">"Save to Zip..."</span>

    <span class="token keyword keyword-def">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
       <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>_plugin_name
    
    <span class="token keyword keyword-def">def</span> <span class="token function">uiName</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
       <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>_ui_name
    
    <span class="token keyword keyword-def">def</span> <span class="token function">supportedExtensions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">[</span><span class="token string">".zip"</span><span class="token punctuation">]</span>

    <span class="token comment"># Override "write"</span>
    <span class="token keyword keyword-def">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> path<span class="token punctuation">,</span> options<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> have_zip<span class="token punctuation">:</span>
            <span class="token keyword keyword-return">return</span> <span class="token boolean">None</span>
        <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> path<span class="token punctuation">:</span>
            <span class="token keyword keyword-return">return</span> <span class="token boolean">None</span>

        <span class="token comment"># Determine the .mtlx filename based on the .zip filename</span>
        zip_basename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        zip_folder <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>zip_basename<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        mtlx_name <span class="token operator">=</span> zip_folder <span class="token operator">+</span> <span class="token string">".mtlx"</span>  <span class="token comment"># .mtlx at root of zip</span>
        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"zip base name: </span><span class="token interpolation"><span class="token punctuation">{</span>zip_basename<span class="token punctuation">}</span></span><span class="token string">, mtlx name: </span><span class="token interpolation"><span class="token punctuation">{</span>mtlx_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

        <span class="token comment"># Write the document to a temporary file in the temp directory (not in a subfolder)</span>
        <span class="token keyword keyword-with">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> tmpdir<span class="token punctuation">:</span>
            mtlx_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmpdir<span class="token punctuation">,</span> mtlx_name<span class="token punctuation">)</span>

            <span class="token comment"># Determine the base directory for resolving relative texture paths</span>
            <span class="token comment"># Use the directory of the source .mtlx file if available, else current working dir</span>
            mtlx_source_dir <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token keyword keyword-if">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token string">'getSourceUri'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                source_uri <span class="token operator">=</span> doc<span class="token punctuation">.</span>getSourceUri<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-if">if</span> source_uri <span class="token keyword keyword-and">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>source_uri<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    mtlx_source_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>source_uri<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> mtlx_source_dir<span class="token punctuation">:</span>
                mtlx_source_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword keyword-with">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> z<span class="token punctuation">:</span>

                <span class="token comment"># Save all texture files under 'textures/'</span>
                texture_file_list <span class="token operator">=</span> resolve_all_image_paths<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
                <span class="token keyword keyword-for">for</span> element_path<span class="token punctuation">,</span> texture <span class="token keyword keyword-in">in</span> texture_file_list<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token comment"># If texture path is not absolute, resolve it relative to the document's path</span>
                    abs_texture <span class="token operator">=</span> texture
                    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isabs<span class="token punctuation">(</span>texture<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Texture path is relative: </span><span class="token interpolation"><span class="token punctuation">{</span>texture<span class="token punctuation">}</span></span><span class="token string">, resolving against </span><span class="token interpolation"><span class="token punctuation">{</span>mtlx_source_dir<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        abs_texture <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>normpath<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>mtlx_source_dir<span class="token punctuation">,</span> texture<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword keyword-if">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>abs_texture<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        arcname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"textures"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>texture<span class="token punctuation">)</span><span class="token punctuation">)</span>
                        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Adding texture to ZIP: </span><span class="token interpolation"><span class="token punctuation">{</span>abs_texture<span class="token punctuation">}</span></span><span class="token string"> as </span><span class="token interpolation"><span class="token punctuation">{</span>arcname<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        z<span class="token punctuation">.</span>write<span class="token punctuation">(</span>abs_texture<span class="token punctuation">,</span> arcname<span class="token operator">=</span>arcname<span class="token punctuation">)</span>

                        <span class="token comment"># Replace the references in the materialx</span>
                        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Updating texture path on element </span><span class="token interpolation"><span class="token punctuation">{</span>element_path<span class="token punctuation">}</span></span><span class="token string"> from </span><span class="token interpolation"><span class="token punctuation">{</span>texture<span class="token punctuation">}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token punctuation">{</span>arcname<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        doc<span class="token punctuation">.</span>getDescendant<span class="token punctuation">(</span>element_path<span class="token punctuation">)</span><span class="token punctuation">.</span>setValueString<span class="token punctuation">(</span>arcname<span class="token punctuation">)</span>
                    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
                        logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Texture file not found: </span><span class="token interpolation"><span class="token punctuation">{</span>abs_texture<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

                mx<span class="token punctuation">.</span>writeToXmlFile<span class="token punctuation">(</span>doc<span class="token punctuation">,</span> mtlx_path<span class="token punctuation">)</span>
                logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Write MaterialX document to temp file: </span><span class="token interpolation"><span class="token punctuation">{</span>mtlx_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token comment"># Add the .mtlx file at the root of the zip</span>
                z<span class="token punctuation">.</span>write<span class="token punctuation">(</span>mtlx_path<span class="token punctuation">,</span> arcname<span class="token operator">=</span>mtlx_name<span class="token punctuation">)</span>
                logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Added MaterialX document to ZIP as: </span><span class="token interpolation"><span class="token punctuation">{</span>mtlx_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> 

                logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"MaterialX document and textures saved to ZIP: </span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span>
</code></pre><h3 id="management">Management </h3>
<ul>
<li>A <code>DocumentHandler</code> class provides similar functionality to the existing <code>ImageHandler</code> and <code>GeometryHandler</code> classes.</li>
<li>If source and destination formats are both exposed in the API then it is possible to use the <code>DocumentHandler</code> as a<br>
hub-and-spoke mechanism to support additional conversions by chaining the serializers.</li>
</ul>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">DocumentHandler</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> DocumentHandlerPtr <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>DocumentHandler<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">DocumentHandler</span> 
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token keyword keyword-static">static</span> DocumentHandlerPtr <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span>DocumentHandler<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token operator">~</span><span class="token function">DocumentHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">addDocumentReader</span><span class="token punctuation">(</span>DocumentReaderPtr reader<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        documentReaders<span class="token punctuation">[</span>reader<span class="token operator">-&gt;</span><span class="token function">getIdentifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> reader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-void">void</span> <span class="token function">addDocumentWriter</span><span class="token punctuation">(</span>DocumentWriterPtr writer<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        documentWriters<span class="token punctuation">[</span>writer<span class="token operator">-&gt;</span><span class="token function">getIdentifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> writer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword keyword-private">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>unordered_map<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">,</span> DocumentReaderPtr<span class="token operator">&gt;</span> documentReaders<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>unordered_map<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">,</span> DocumentWriterPtr<span class="token operator">&gt;</span> documentWriters<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="python-slx-reader-example">Python SLX Reader Example </h3>
<p>This example specified a reader which compiles SLX (.mxsl) files to MaterialX (.mtlx) documents.<br>
It includes sample code showing how to add the reader to the document handler.</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> MaterialX <span class="token keyword keyword-as">as</span> mx
<span class="token keyword keyword-import">import</span> logging
<span class="token keyword keyword-import">import</span> os

logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">'slxPlugin'</span><span class="token punctuation">)</span>

have_slx <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-from">from</span> pathlib <span class="token keyword keyword-import">import</span> Path
    <span class="token keyword keyword-from">from</span> mxslc<span class="token punctuation">.</span>Decompiler<span class="token punctuation">.</span>decompile <span class="token keyword keyword-import">import</span> Decompiler
    <span class="token keyword keyword-from">from</span> mxslc<span class="token punctuation">.</span>compile_file <span class="token keyword keyword-import">import</span> compile_file
    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"SLX module loaded successfully"</span><span class="token punctuation">)</span>
    have_slx <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword keyword-except">except</span> ImportError<span class="token punctuation">:</span>
    <span class="token keyword keyword-raise">raise</span> ImportError<span class="token punctuation">(</span><span class="token string">"SLX module not found. Please ensure it is installed."</span><span class="token punctuation">)</span>

<span class="token keyword keyword-class">class</span> <span class="token class-name">SLXLoader</span><span class="token punctuation">(</span>mx<span class="token punctuation">.</span>DocumentReader<span class="token punctuation">)</span><span class="token punctuation">:</span>
    _name <span class="token operator">=</span> <span class="token string">"ShadingLanguageX"</span>
    _ui_name <span class="token operator">=</span> <span class="token string">"Load from SLX..."</span>

    <span class="token keyword keyword-def">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>_name

    <span class="token keyword keyword-def">def</span> <span class="token function">uiName</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>_ui_name

    <span class="token keyword keyword-def">def</span> <span class="token function">supportedExtensions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">[</span><span class="token string">".mxsl"</span><span class="token punctuation">]</span>

    <span class="token keyword keyword-def">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        doc <span class="token operator">=</span> <span class="token boolean">None</span>
        mtlx_path <span class="token operator">=</span> path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'.mxsl'</span><span class="token punctuation">,</span> <span class="token string">'.mtlx'</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
            logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Compiling from SLX to MaterialX: </span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">..."</span></span><span class="token punctuation">)</span>
            compile_file<span class="token punctuation">(</span>Path<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> mtlx_path<span class="token punctuation">)</span>
            <span class="token comment"># Check if the MaterialX file was created</span>
            <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>mtlx_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
                logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Failed to compile SLX file to MaterialX: "</span> <span class="token operator">+</span> path<span class="token punctuation">)</span>
            <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
                doc <span class="token operator">=</span> mx<span class="token punctuation">.</span>createDocument<span class="token punctuation">(</span><span class="token punctuation">)</span>
                logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Compiled SLX file to MaterialX: </span><span class="token interpolation"><span class="token punctuation">{</span>mtlx_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                mx<span class="token punctuation">.</span>readFromXmlFile<span class="token punctuation">(</span>doc<span class="token punctuation">,</span> mtlx_path<span class="token punctuation">)</span>                
        <span class="token keyword keyword-except">except</span> Exception <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
            logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to compile SLX file: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>                
        <span class="token keyword keyword-return">return</span> doc

<span class="token comment"># -------------------------------------</span>
<span class="token comment"># Register loader with document handler</span>
<span class="token comment"># -------------------------------------</span>
loader <span class="token operator">=</span> SLXLoader<span class="token punctuation">(</span><span class="token punctuation">)</span>
manager <span class="token operator">=</span> mx<span class="token punctuation">.</span>getDocumentHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
manager<span class="token punctuation">.</span>addDocumentReader<span class="token punctuation">(</span>loader<span class="token punctuation">)</span>
</code></pre><h3 id="language-wrappers">Language Wrappers </h3>
<h4 id="python">Python </h4>
<ul>
<li>
<p>The existing <code>pybind11</code> mechanism is used to expose the new interface and XML serialization classes.</p>
</li>
<li>
<p>"Trampoline" classes are added to allow calling of Python interfaces from C++.</p>
</li>
<li>
<p>All interfaces are exposed as part of the package within the <code>MaterialXCore</code> module.</p>
</li>
<li>
<p>XML serialization and deserialization will be exposed as part of package in the <code>MaterialXFormat</code> module.</p>
</li>
</ul>
<h3 id="javascript">Javascript </h3>
<ul>
<li>Create wrappers using <code>emscripten</code> to expose the C++ interfaces as <code>WASM</code> implementations with <code>JavaScript</code> wrappers.</li>
<li>Both based interfaces and XML wrappers would be packaged with the <code>JsMaterialXCore</code> Javascript and WASM modules which includes <code>MaterialXFormat</code> wrappers.</li>
</ul>
<h2 id="addendum-other-transformations">Addendum: Other Transformations </h2>
<p>We will only briefly mention that additional transformations can be introduced including those that perform modifications in-place on a <code>Document</code>.<br>
This would allow for a set of reusable and safe operations to be defined which hides the low level details currently exposed by the API<br>
which can be complex and error-prone.</p>
<p>For example we can add in an "edit" interface as follows:</p>
<pre data-role="codeBlock" data-info="c++" class="language-cpp c++"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">DocumentOperator</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword keyword-public">public</span> <span class="token class-name">Operation</span></span>
<span class="token punctuation">{</span>
  <span class="token keyword keyword-public">public</span><span class="token operator">:</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token operator">~</span><span class="token function">DocumentOperator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-virtual">virtual</span> <span class="token keyword keyword-bool">bool</span> <span class="token function">edit</span><span class="token punctuation">(</span>mx<span class="token double-colon punctuation">::</span>DocumentPtr doc<span class="token punctuation">,</span> OperationOptions<span class="token operator">*</span> options <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-bool">bool</span> <span class="token function">isUndoable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token punctuation">{</span> <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword keyword-virtual">virtual</span> <span class="token keyword keyword-void">void</span> <span class="token function">undo</span><span class="token punctuation">(</span>mx<span class="token double-colon punctuation">::</span>DocumentPtr doc<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-bool">bool</span> <span class="token function">isTopologicalChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-const">const</span> <span class="token punctuation">{</span> <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>with the following node connection operator example:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">ConnectionParameters</span><span class="token punctuation">(</span>mx<span class="token punctuation">.</span>OperationOptions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-def">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputNodePath<span class="token punctuation">,</span> inputName<span class="token punctuation">,</span> outputNodePath<span class="token punctuation">,</span> outputName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>inputNodePath <span class="token operator">=</span> inputNodePath
        self<span class="token punctuation">.</span>inputName <span class="token operator">=</span> inputName
        self<span class="token punctuation">.</span>outputNode <span class="token operator">=</span> outputNodePath
        self<span class="token punctuation">.</span>outputName <span class="token operator">=</span> outputName

<span class="token keyword keyword-class">class</span> <span class="token class-name">ConnectNode</span><span class="token punctuation">(</span>mx<span class="token punctuation">.</span>DocumentOperator<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword keyword-def">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> params<span class="token punctuation">:</span> ConnectionParameters<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>params <span class="token operator">=</span> params

    <span class="token keyword keyword-def">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> doc<span class="token punctuation">,</span> options<span class="token punctuation">:</span> ConnectionParameters<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        Connect an input on one node to an output on another node. Existence and type checking are performed.
        Returns input port with connection set if successful. Otherwise None is returned.
        '''</span>
        inputNode <span class="token operator">=</span> doc<span class="token punctuation">.</span>getDescendant<span class="token punctuation">(</span>options<span class="token punctuation">.</span>inputNodePath<span class="token punctuation">)</span>
        outputNode <span class="token operator">=</span> doc<span class="token punctuation">.</span>getDescendant<span class="token punctuation">(</span>options<span class="token punctuation">.</span>outputNodePath<span class="token punctuation">)</span>

        <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> inputNode <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-not">not</span> outputNode<span class="token punctuation">:</span>
            <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span>

        <span class="token comment"># Add an input to the downstream node if it does not exist</span>
        inputPort <span class="token operator">=</span> inputNode<span class="token punctuation">.</span>addInputFromNodeDef<span class="token punctuation">(</span>options<span class="token punctuation">.</span>inputName<span class="token punctuation">)</span>

        <span class="token comment"># Check for the type.</span>
        outputType <span class="token operator">=</span> outputNode<span class="token punctuation">.</span>getType<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># If there is more than one output then we need to find the output type</span>
        <span class="token comment"># from the output with the name we are interested in.</span>
        outputPortFound <span class="token operator">=</span> <span class="token boolean">None</span>
        outputPorts <span class="token operator">=</span> outputNode<span class="token punctuation">.</span>getOutputs<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-if">if</span> outputPorts<span class="token punctuation">:</span>
            <span class="token comment"># Look for an output with a given name, or the first if not found</span>
            <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> options<span class="token punctuation">.</span>outputName<span class="token punctuation">:</span>
                outputPortFound <span class="token operator">=</span> outputPorts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
                outputPortFound <span class="token operator">=</span> outputNode<span class="token punctuation">.</span>getOutput<span class="token punctuation">(</span>options<span class="token punctuation">.</span>outputName<span class="token punctuation">)</span>

        <span class="token comment"># If the output port is not found on the node instance then</span>
        <span class="token comment"># look for it the corresponding definition</span>
        <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> outputPortFound<span class="token punctuation">:</span>
            outputNodedef <span class="token operator">=</span> outputNode<span class="token punctuation">.</span>getNodeDef<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-if">if</span> outputNodedef<span class="token punctuation">:</span>
                outputPorts <span class="token operator">=</span> outputNodedef<span class="token punctuation">.</span>getOutputs<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token keyword keyword-if">if</span> outputPorts<span class="token punctuation">:</span>
                    <span class="token comment"># Look for an output with a given name, or the first if not found</span>
                    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> options<span class="token punctuation">.</span>outputName<span class="token punctuation">:</span>
                        outputPortFound <span class="token operator">=</span> outputPorts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
                        outputPortFound <span class="token operator">=</span> outputNodedef<span class="token punctuation">.</span>getOutput<span class="token punctuation">(</span>options<span class="token punctuation">.</span>outputName<span class="token punctuation">)</span>

        <span class="token keyword keyword-if">if</span> outputPortFound<span class="token punctuation">:</span>
            outputType <span class="token operator">=</span> outputPortFound<span class="token punctuation">.</span>getType<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-elif">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>outputName<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">'No output port found matching: '</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>outputName<span class="token punctuation">)</span>

        <span class="token keyword keyword-if">if</span> inputPort<span class="token punctuation">.</span>getType<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> outputType<span class="token punctuation">:</span>
            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">'Input type (%s) and output type (%s) do not match: '</span> <span class="token operator">%</span> <span class="token punctuation">(</span>inputPort<span class="token punctuation">.</span>getType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> outputType<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span>

        <span class="token keyword keyword-if">if</span> inputPort<span class="token punctuation">:</span>
            <span class="token comment"># Remove any value, and set a "connection" by setting the node name</span>
            inputPort<span class="token punctuation">.</span>removeAttribute<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span>
            attributeName <span class="token operator">=</span> <span class="token string">'nodename'</span> <span class="token keyword keyword-if">if</span> outputNode<span class="token punctuation">.</span>isA<span class="token punctuation">(</span>mx<span class="token punctuation">.</span>Node<span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> <span class="token string">'nodegraph'</span>
            inputPort<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span>attributeName<span class="token punctuation">,</span> outputNode<span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-if">if</span> outputNode<span class="token punctuation">.</span>getType<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'multioutput'</span> <span class="token keyword keyword-and">and</span> options<span class="token punctuation">.</span>outputName<span class="token punctuation">:</span>
                inputPort<span class="token punctuation">.</span>setOutputString<span class="token punctuation">(</span>options<span class="token punctuation">.</span>outputName<span class="token punctuation">)</span>
        
        <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span>
</code></pre><h3 id="addendum--class-diagram">Addendum : Class Diagram </h3>
<div class="mermaid">classDiagram
    direction LR

    %% ===================
    %% Base Classes
    %% ===================
    class Operation {
        - string _name
        + Operation(name: string)
        + ~Operation()
        + name() string
    }

    class OperationOptions {
        &lt;&lt;interface&gt;&gt;
        + ~OperationOptions()
    }

    class KeyValueOptions {
        - KeyValueMap _options
        + setOption(key: string, value: ValuePtr)
        + getOption(key: string) ValuePtr
    }

    OperationOptions &lt;|-- KeyValueOptions

    %% ===================
    %% Document IO Interfaces
    %% ===================
    class DocumentReader {
        &lt;&lt;abstract&gt;&gt;
        + read(uri: FilePath, options: OperationOptions*) DocumentPtr
        + read(data: string, options: OperationOptions*) DocumentPtr
        + read(stream: istream&amp;, options: OperationOptions*) DocumentPtr
        + supportedExtensions() StringVec
    }

    class DocumentWriter {
        &lt;&lt;abstract&gt;&gt;
        + write(doc: DocumentPtr, uri: FilePath, options: OperationOptions*) bool
        + write(doc: DocumentPtr, data: string, options: OperationOptions*) bool
        + write(doc: DocumentPtr, stream: ostream&amp;, options: OperationOptions*) void
        + supportedExtensions() StringVec
    }

    Operation &lt;|-- DocumentReader
    Operation &lt;|-- DocumentWriter
    Operation &lt;|-- DocumentOperator

    %% ===================
    %% XML Implementations
    %% ===================
    class XmlDocumentReadOptions {
        - FileSearchPath _searchPath
        - DocumentPtr _standardLibrary
    }

    class XMLDocumentReader {
        - StringVec _supportedExtensions
        + read(uri: FilePath, options: OperationOptions*) DocumentPtr
        + read(data: string, options: OperationOptions*) DocumentPtr
        + read(stream: istream&amp;, options: OperationOptions*) DocumentPtr
        + supportedExtensions() StringVec
    }

    class XmlDocumentWriteOptions {
        - FileSearchPath _searchPath
    }

    class XMLDocumentWriter {
        - StringVec _supportedExtensions
        + write(doc: DocumentPtr, uri: FilePath, options: OperationOptions*) bool
        + write(doc: DocumentPtr, data: string, options: OperationOptions*) bool
        + write(doc: DocumentPtr, stream: ostream&amp;, options: OperationOptions*) bool
        + supportedExtensions() StringVec
    }

    OperationOptions &lt;|-- XmlDocumentReadOptions
    OperationOptions &lt;|-- XmlDocumentWriteOptions
    DocumentReader &lt;|-- XMLDocumentReader
    DocumentWriter &lt;|-- XMLDocumentWriter

    %% ===================
    %% HTTP Reader
    %% ===================
    class HTTPXMLOptions {
        - int _timeout
        - int _connectTimeout
        - StringMap _headers
        + setHttpOptions(options: HttpRequestOptions)
        + setTimeout(timeout: int)
        + setHeaders(headers: StringMap)
        + timeout() int
        + connectTimeout() int
    }

    class HTTPXMLReader {
        - StringVec _supportedExtensions
        + read(uri: FilePath, options: OperationOptions*) DocumentPtr
        + supportedExtensions() StringVec
    }

    OperationOptions &lt;|-- HTTPXMLOptions
    DocumentReader &lt;|-- HTTPXMLReader

    %% ===================
    %% Document Operators
    %% ===================
    class DocumentOperator {
        &lt;&lt;abstract&gt;&gt;
        + edit(doc: DocumentPtr, options: OperationOptions*) bool
        + isUndoable() bool
        + undo(doc: DocumentPtr)
        + isTopologicalChange() bool
    }

    class ConnectionParameters {
        + inputNodePath
        + inputName
        + outputNodePath
        + outputName
    }

    class ConnectNode {
        - params: ConnectionParameters
        + edit(doc: DocumentPtr, options: ConnectionParameters) bool
    }

    OperationOptions &lt;|-- ConnectionParameters
    DocumentOperator &lt;|-- ConnectNode

    %% ===================
    %% Document Handler
    %% ===================
    class DocumentHandler {
        - map[string, DocumentReaderPtr] documentReaders
        - map[string, DocumentWriterPtr] documentWriters
        - map[string, DocumentOperatorPtr] documentOperators
        + addDocumentReader(reader: DocumentReaderPtr)
        + addDocumentWriter(writer: DocumentWriterPtr)
        + addDocumentOperator(operator: DocumentOperatorPtr)
    }

</div>
      </div>
      
      
    
    
    <script type="module">
// TODO: If ZenUML gets integrated into mermaid in the future,
//      we can remove the following lines.


var MERMAID_CONFIG = ({"startOnLoad":false});
if (typeof MERMAID_CONFIG !== 'undefined') {
  MERMAID_CONFIG.startOnLoad = false
  MERMAID_CONFIG.cloneCssStyles = false
  MERMAID_CONFIG.theme = "default"
}

mermaid.initialize(MERMAID_CONFIG || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidetransitionend', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
} else {
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
}
</script>
    
    
    
  
    </body></html>